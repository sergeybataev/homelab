apiVersion: kustomize.toolkit.fluxcd.io/v1
kind: Kustomization
metadata:
  name: not-used
spec:
  patches:
  # add decryption into fluxcd Kustomization
  - path: ./patches/defaults.decryption.yaml
    target:
      group: kustomize.toolkit.fluxcd.io
      version: v1
      kind: Kustomization

  # add defaults into fluxcd Kustomization
  - path: ./patches/defaults.yaml
    target:
      group: kustomize.toolkit.fluxcd.io
      version: v1
      kind: Kustomization
      labelSelector: kustomization.flux.home.arpa/default in (true)

  # kustomization.flux.home.arpa/default: "true"
  - path: ./patches/defaults.sourceRef.yaml
    target:
      group: kustomize.toolkit.fluxcd.io
      version: v1
      kind: Kustomization
      labelSelector: kustomization.flux.home.arpa/default in (true)

  # substitution.flux.home.arpa/disabled: "false"
  - path: ./patches/defaults.substitution.yaml
    target:
      group: kustomize.toolkit.fluxcd.io
      kind: Kustomization
      labelSelector: substitution.flux.home.arpa/disabled notin (true)

  # dependsOn: cluster
  - path: ./patches/defaults.dependson.yaml
    target:
      group: kustomize.toolkit.fluxcd.io
      version: v1
      kind: Kustomization
      labelSelector: kustomization.flux.home.arpa/default in (true)

  # prune.flux.home.arpa/disabled: "true"
  - path: ./patches/defaults.prune.yaml
    target:
      group: kustomize.toolkit.fluxcd.io
      version: v1
      kind: Kustomization
      labelSelector: prune.flux.home.arpa/disabled in (true)

  # wait.flux.home.arpa/disabled: "true" => wait: false
  - path: ./patches/defaults.wait.yaml
    target:
      group: kustomize.toolkit.fluxcd.io
      version: v1
      kind: Kustomization
      labelSelector: wait.flux.home.arpa/disabled in (true)
  - path: ./hr.yaml
    target:
      group: helm.toolkit.fluxcd.io
      version: v2beta1
      kind: HelmRelease
      labelSelector: helm.flux.home.arpa/default notin (false)
  - path: ./hr.app-template.yaml
    target:
      group: helm.toolkit.fluxcd.io
      version: v2beta1
      kind: HelmRelease
      labelSelector: helm.flux.home.arpa/app-template=true
